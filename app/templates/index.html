{% extends "base.html" %}

{% block title %}NEURAL PLUGIN MATRIX - HOME{% endblock %}

{% block hero %}
<section class="hero">
    <div class="container">
        <h1>DYNAMIC NEURAL PLUGIN MATRIX</h1>
        <p>FastAPI + Pydantic neural interface architecture. Real-time plugin discovery and execution in the digital frontier.</p>
        <div class="mt-4">
            <a href="#plugins" class="btn btn-primary">ACCESS PLUGINS</a>
            <a href="/how-to" class="btn btn-secondary">INTERFACE GUIDE</a>
        </div>
    </div>
</section>
{% endblock %}

{% block content %}
<div class="container">
    <section id="plugins" class="mt-5 mb-5">
        <h2 class="text-center mb-4">AVAILABLE NEURAL MODULES</h2>
        
        <div class="row">
            {% for plugin in plugins %}
            <div class="col-12 col-md-6 col-lg-4 mb-4">
                <div class="card fade-in">
                    <div class="card-header">
                        <h5 class="card-title">{{ plugin.name|upper }}</h5>
                        <small class="text-secondary">Version {{ plugin.version }}</small>
                    </div>
                    <div class="card-body">
                        <p>{{ plugin.description }}</p>
                        
                        {% if plugin.tags %}
                        <div class="mb-3">
                            {% for tag in plugin.tags %}
                                <span class="badge">{{ tag|upper }}</span>
                            {% endfor %}
                        </div>
                        {% endif %}
                        
                        <!-- Plugin Status Indicator -->
                        <div class="mb-3">
                            <strong class="text-primary">System Status:</strong>
                            {% if plugin.dependency_status and plugin.dependency_status.all_met %}
                                <span class="text-success">OPERATIONAL</span>
                            {% else %}
                                <span class="text-accent">DEPENDENCY ERROR</span>
                            {% endif %}
                        </div>
                        
                        <!-- Plugin Info Grid -->
                        <dl class="mb-3">
                            <dt>Plugin ID:</dt>
                            <dd><code>{{ plugin.id }}</code></dd>
                            
                            <dt>Input Fields:</dt>
                            <dd>{{ plugin.inputs|length }} field(s)</dd>
                            
                            <dt>Output Format:</dt>
                            <dd>{{ plugin.output.name }}</dd>
                            
                            {% if plugin.author %}
                            <dt>Author:</dt>
                            <dd>{{ plugin.author }}</dd>
                            {% endif %}
                        </dl>
                        
                        <!-- Dependencies Status -->
                        {% if plugin.dependency_status and plugin.dependency_status.details %}
                        <div class="mb-3">
                            <strong class="text-primary">Dependencies:</strong>
                            {% for dep in plugin.dependency_status.details %}
                                <div class="text-secondary">
                                    {{ dep.name }}: 
                                    {% if dep.met %}
                                        <span class="text-success">✓ INSTALLED</span>
                                    {% else %}
                                        <span class="text-accent">✗ MISSING</span>
                                    {% endif %}
                                </div>
                            {% endfor %}
                        </div>
                        {% endif %}
                        
                        <div class="text-center">
                            {% if plugin.dependency_status and plugin.dependency_status.all_met %}
                                <a href="/plugin/{{ plugin.id }}" class="btn btn-primary">EXECUTE MODULE</a>
                            {% else %}
                                <button class="btn btn-primary" disabled>DEPENDENCIES REQUIRED</button>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        
        {% if not plugins %}
        <div class="text-center p-5">
            <div class="card">
                <div class="card-body">
                    <h3 class="text-accent">NO NEURAL MODULES DETECTED</h3>
                    <p class="text-secondary">System scan complete. No plugins found in neural matrix.</p>
                    <p class="text-secondary">Check plugin directory: <code>app/plugins/</code></p>
                    <a href="/how-to" class="btn btn-outline">LEARN TO BUILD MODULES</a>
                </div>
            </div>
        </div>
        {% endif %}
    </section>
    
    <!-- System Stats Section -->
    <section class="mt-5 mb-5">
        <div class="row">
            <div class="col-12 col-md-4 mb-3">
                <div class="card text-center">
                    <div class="card-body">
                        <h3 class="text-primary">{{ plugins|length }}</h3>
                        <p class="text-secondary">ACTIVE MODULES</p>
                    </div>
                </div>
            </div>
            <div class="col-12 col-md-4 mb-3">
                <div class="card text-center">
                    <div class="card-body">
                        <h3 class="text-success">{{ plugins|selectattr('dependency_status.all_met')|list|length }}</h3>
                        <p class="text-secondary">OPERATIONAL</p>
                    </div>
                </div>
            </div>
            <div class="col-12 col-md-4 mb-3">
                <div class="card text-center">
                    <div class="card-body">
                        <h3 class="text-accent">{{ plugins|rejectattr('dependency_status.all_met')|list|length }}</h3>
                        <p class="text-secondary">ERRORS DETECTED</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
// Intersection Observer for card animations
const observerCyber = new IntersectionObserver((entries) => {
    entries.forEach((entry, index) => {
        if (entry.isIntersecting) {
            setTimeout(() => {
                entry.target.style.animation = 'fadeInCyber 1s ease-out both';
            }, index * 200);
        }
    });
}, {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
});

// Observe cards for animation
document.querySelectorAll('.card').forEach(card => {
    observerCyber.observe(card);
});

// Smooth scroll for "ACCESS PLUGINS" button
document.querySelector('a[href="#plugins"]').addEventListener('click', function(e) {
    e.preventDefault();
    document.querySelector('#plugins').scrollIntoView({
        behavior: 'smooth'
    });
});
</script>
{% endblock %} 