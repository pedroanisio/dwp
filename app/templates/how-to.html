{% extends "base.html" %}

{% block title %}NEURAL INTERFACE GUIDE{% endblock %}

{% block content %}
<div class="container">
    <!-- Hero Section -->
    <div class="hero" style="padding: 80px 0;">
        <div class="text-center">
            <h1 class="glitch" data-text="NEURAL INTERFACE GUIDE">NEURAL INTERFACE GUIDE</h1>
            <p class="text-secondary">Complete documentation for building and deploying neural plugin modules</p>
        </div>
    </div>

    <div class="row">
        <div class="col-12 col-lg-9">
            <!-- Introduction Card -->
            <div class="card mb-5">
                <div class="card-header">
                    <h2 class="card-title">SYSTEM OVERVIEW</h2>
                </div>
                <div class="card-body">
                    <p>This neural interface guide provides complete specifications for creating, testing, and deploying custom plugin modules within the matrix. Each module is an autonomous unit with defined inputs, outputs, and processing capabilities.</p>
                    
                    <div class="alert alert-primary mt-3">
                        <strong>âš¡ NEURAL ARCHITECTURE:</strong> All modules are self-contained within the <code>app/plugins/</code> directory and auto-discovered by the system matrix.
                    </div>
                </div>
            </div>

            <!-- Plugin Anatomy -->
            <div class="card mb-5">
                <div class="card-header">
                    <h2 class="card-title">MODULE ARCHITECTURE</h2>
                </div>
                <div class="card-body">
                    <p>Every neural module requires two core components for system integration:</p>
                    
                    <div class="row mt-4">
                        <div class="col-12 col-md-6">
                            <div class="alert alert-secondary">
                                <h4 class="text-primary">manifest.json</h4>
                                <p class="mb-0">Defines module metadata, UI specifications, and dependency requirements for system integration.</p>
                            </div>
                        </div>
                        <div class="col-12 col-md-6">
                            <div class="alert alert-secondary">
                                <h4 class="text-accent">plugin.py</h4>
                                <p class="mb-0">Contains the core processing logic and execution algorithms for the neural module.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="alert alert-success mt-3">
                        <strong>NOTE:</strong> For modules with internal Python packages, include an empty <code>__init__.py</code> file in the module directory.
                    </div>
                </div>
            </div>

            <!-- Development Steps -->
            <div class="card mb-5">
                <div class="card-header">
                    <h2 class="card-title">DEVELOPMENT PROTOCOL</h2>
                </div>
                <div class="card-body">
                    
                    <!-- Step 1: Manifest -->
                    <div class="accordion mb-4">
                        <div class="accordion-header">
                            <button type="button" class="accordion-button" onclick="toggleStep('step1')">
                                STEP 1: DEFINE MANIFEST SPECIFICATIONS
                            </button>
                        </div>
                        <div id="step1" class="accordion-body" style="display: none;">
                            <p>The <code>manifest.json</code> file serves as the neural interface definition. It specifies all metadata, UI components, validation rules, and system dependencies.</p>
                            
                            <h5 class="text-primary mt-4">EXAMPLE MANIFEST:</h5>
                            <pre><code>{
  "id": "neural_processor",
  "name": "Neural Data Processor",
  "version": "2.0.0",
  "description": "Advanced neural network processing module with real-time analysis.",
  "author": "Neural Systems Division",
  "inputs": [
    {
      "name": "input_data",
      "label": "Data Input Stream",
      "field_type": "textarea",
      "required": true,
      "placeholder": "Enter neural data for processing...",
      "validation": {
        "min_length": 10,
        "max_length": 50000
      },
      "help": "Raw data input for neural processing algorithms."
    },
    {
      "name": "processing_mode",
      "label": "Processing Mode",
      "field_type": "select",
      "required": true,
      "options": ["STANDARD", "ENHANCED", "DEEP_ANALYSIS"],
      "default_value": "STANDARD"
    },
    {
      "name": "enable_optimization",
      "label": "Enable Neural Optimization",
      "field_type": "checkbox",
      "required": false,
      "default_value": true
    }
  ],
  "output": {
    "name": "neural_analysis_result",
    "description": "Processed neural analysis with enhanced metrics",
    "schema": {
      "type": "object",
      "properties": {
        "analysis_score": {"type": "number"},
        "confidence_level": {"type": "number"},
        "processing_time": {"type": "number"},
        "data_points": {"type": "array"}
      }
    }
  },
  "tags": ["neural", "processing", "analysis"],
  "dependencies": {
    "external": [
      {
        "name": "tensorflow",
        "help": "TensorFlow is required for neural processing. Install with: pip install tensorflow"
      }
    ]
  }
}</code></pre>
                        </div>
                    </div>

                    <!-- Step 2: Plugin Logic -->
                    <div class="accordion mb-4">
                        <div class="accordion-header">
                            <button type="button" class="accordion-button" onclick="toggleStep('step2')">
                                STEP 2: IMPLEMENT PROCESSING LOGIC
                            </button>
                        </div>
                        <div id="step2" class="accordion-body" style="display: none;">
                            <p>The <code>plugin.py</code> file must implement a <code>Plugin</code> class with an <code>execute</code> method. This method processes input data and returns structured output.</p>
                            
                            <h5 class="text-primary mt-4">IMPLEMENTATION TEMPLATE:</h5>
                            <pre><code>from typing import Dict, Any
import time
import json

class Plugin:
    """
    Neural Processing Module
    Handles data analysis and processing operations
    """
    
    def execute(self, data: Dict[str, Any]) -> Dict[str, Any]:
        """
        Execute neural processing on input data
        
        Args:
            data: Dictionary containing validated input parameters
            
        Returns:
            Dictionary with processing results
        """
        start_time = time.time()
        
        # Extract input parameters
        input_data = data.get('input_data', '')
        processing_mode = data.get('processing_mode', 'STANDARD')
        enable_optimization = data.get('enable_optimization', False)
        
        # Validate inputs
        if not input_data:
            raise ValueError("Neural data input is required for processing")
        
        # Process data based on mode
        if processing_mode == "ENHANCED":
            result = self._enhanced_processing(input_data)
        elif processing_mode == "DEEP_ANALYSIS":
            result = self._deep_analysis(input_data)
        else:
            result = self._standard_processing(input_data)
        
        # Apply optimization if enabled
        if enable_optimization:
            result = self._optimize_result(result)
        
        processing_time = time.time() - start_time
        
        # Return structured output
        return {
            "analysis_score": result.get("score", 0.0),
            "confidence_level": result.get("confidence", 0.0),
            "processing_time": processing_time,
            "data_points": result.get("points", []),
            "optimization_applied": enable_optimization,
            "processing_mode": processing_mode
        }
    
    def _standard_processing(self, data: str) -> Dict[str, Any]:
        """Standard neural processing algorithm"""
        # Implement your processing logic here
        return {
            "score": len(data) * 0.1,
            "confidence": 0.85,
            "points": data.split()[:10]
        }
    
    def _enhanced_processing(self, data: str) -> Dict[str, Any]:
        """Enhanced neural processing with advanced algorithms"""
        # Implement enhanced processing
        return {
            "score": len(data) * 0.15,
            "confidence": 0.92,
            "points": data.split()[:20]
        }
    
    def _deep_analysis(self, data: str) -> Dict[str, Any]:
        """Deep neural analysis with comprehensive metrics"""
        # Implement deep analysis
        return {
            "score": len(data) * 0.25,
            "confidence": 0.97,
            "points": data.split()
        }
    
    def _optimize_result(self, result: Dict[str, Any]) -> Dict[str, Any]:
        """Apply neural optimization algorithms"""
        result["score"] *= 1.2  # Apply optimization multiplier
        result["confidence"] = min(result["confidence"] * 1.1, 1.0)
        return result
</code></pre>

                            <div class="alert alert-primary mt-3">
                                <strong>FILE OUTPUT:</strong> For modules that generate files, return a dictionary with <code>file_path</code> and <code>file_name</code> keys.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Testing Section -->
            <div class="card mb-5">
                <div class="card-header">
                    <h2 class="card-title">TESTING PROTOCOLS</h2>
                </div>
                <div class="card-body">
                    <p>Test your neural module using multiple validation methods to ensure proper system integration.</p>
                    
                    <div class="row mt-4">
                        <div class="col-12 col-md-6">
                            <h4 class="text-primary">WEB INTERFACE TESTING</h4>
                            <ol class="text-secondary">
                                <li>Navigate to the <a href="/" class="text-accent">Neural Matrix homepage</a></li>
                                <li>Locate your module in the available modules list</li>
                                <li>Click "EXECUTE MODULE" to access the interface</li>
                                <li>Input test data and execute to validate functionality</li>
                            </ol>
                        </div>
                        <div class="col-12 col-md-6">
                            <h4 class="text-accent">API TESTING PROTOCOL</h4>
                            <div class="mt-3">
                                <strong>List available modules:</strong>
                                <pre class="mt-2"><code>curl http://localhost:8000/api/plugins</code></pre>
                                
                                <strong class="mt-3 d-block">Execute module via API:</strong>
                                <pre class="mt-2"><code>curl -X POST http://localhost:8000/api/plugin/neural_processor/execute \
  -H "Content-Type: application/json" \
  -d '{
    "input_data": "Sample neural data for processing",
    "processing_mode": "ENHANCED",
    "enable_optimization": true
  }'</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Troubleshooting -->
            <div class="card mb-5">
                <div class="card-header">
                    <h2 class="card-title">SYSTEM DIAGNOSTICS</h2>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-12 col-md-4">
                            <div class="alert alert-secondary">
                                <h5 class="text-accent">MODULE NOT LOADING</h5>
                                <ul class="mb-0 text-secondary">
                                    <li>Validate <code>manifest.json</code> syntax</li>
                                    <li>Verify <code>Plugin</code> class exists</li>
                                    <li>Check <code>execute</code> method signature</li>
                                    <li>Ensure directory structure is correct</li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-12 col-md-4">
                            <div class="alert alert-secondary">
                                <h5 class="text-accent">DEPENDENCY ERRORS</h5>
                                <ul class="mb-0 text-secondary">
                                    <li>Install external dependencies</li>
                                    <li>Verify system PATH configuration</li>
                                    <li>Check dependency status in module info</li>
                                    <li>Review dependency help messages</li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-12 col-md-4">
                            <div class="alert alert-secondary">
                                <h5 class="text-accent">VALIDATION FAILURES</h5>
                                <ul class="mb-0 text-secondary">
                                    <li>Match input types to manifest specs</li>
                                    <li>Provide all required fields</li>
                                    <li>Check field validation rules</li>
                                    <li>Verify file upload constraints</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="col-12 col-lg-3">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title">QUICK REFERENCE</h5>
                </div>
                <div class="card-body">
                    <h6 class="text-primary">FIELD TYPES</h6>
                    <ul class="list-group mb-3">
                        <li class="list-group-item">text</li>
                        <li class="list-group-item">textarea</li>
                        <li class="list-group-item">number</li>
                        <li class="list-group-item">select</li>
                        <li class="list-group-item">checkbox</li>
                        <li class="list-group-item">file</li>
                    </ul>
                    
                    <h6 class="text-primary">REQUIRED FILES</h6>
                    <ul class="list-group mb-3">
                        <li class="list-group-item">manifest.json</li>
                        <li class="list-group-item">plugin.py</li>
                        <li class="list-group-item">__init__.py (optional)</li>
                    </ul>
                    
                    <h6 class="text-primary">SYSTEM ENDPOINTS</h6>
                    <ul class="list-group">
                        <li class="list-group-item">GET /api/plugins</li>
                        <li class="list-group-item">POST /api/plugin/{id}/execute</li>
                        <li class="list-group-item">GET /plugin/{id}</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
// Toggle accordion steps
function toggleStep(stepId) {
    const element = document.getElementById(stepId);
    const button = event.target;
    
    if (element.style.display === 'none') {
        element.style.display = 'block';
        button.textContent = button.textContent.replace('DEFINE', 'HIDE').replace('IMPLEMENT', 'HIDE');
    } else {
        element.style.display = 'none';
        button.textContent = button.textContent.replace('HIDE', 'DEFINE').replace('HIDE', 'IMPLEMENT');
    }
}

// Initialize page
document.addEventListener('DOMContentLoaded', function() {
    // Animate cards on load
    document.querySelectorAll('.card').forEach((card, index) => {
        card.style.animation = `fadeInCyber 0.8s ease-out ${index * 0.1}s both`;
    });
    
    // Random glitch effect for title
    setTimeout(() => {
        const title = document.querySelector('.glitch');
        if (title) {
            title.style.animation = 'glitch-1 0.5s ease-in-out';
            setTimeout(() => {
                title.style.animation = '';
            }, 500);
        }
    }, 2000);
});

// Copy code to clipboard
document.querySelectorAll('pre code').forEach(codeBlock => {
    codeBlock.addEventListener('click', function() {
        navigator.clipboard.writeText(this.textContent).then(() => {
            // Visual feedback
            const original = this.style.background;
            this.style.background = 'rgba(0, 245, 255, 0.2)';
            setTimeout(() => {
                this.style.background = original;
            }, 500);
        });
    });
    
    // Add hover effect
    codeBlock.style.cursor = 'pointer';
    codeBlock.title = 'Click to copy';
});
</script>
{% endblock %} 