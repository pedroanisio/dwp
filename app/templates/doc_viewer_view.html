<!-- NEURAL DOCUMENT VIEWER TEMPLATE -->
<!-- Cyberpunk-styled template for displaying structured JSON documents -->

{% from 'doc_viewer_macros.html' import render_content_block, render_heading, render_paragraph, render_div, render_quote, render_raw_html, render_structural, render_inline_content %}

<div class="doc-viewer-container fade-in">
    <!-- Document Header Section -->
    <div class="card mb-4">
        <div class="card-header">
            <h2 class="card-title text-center">NEURAL DOCUMENT INTERFACE</h2>
            <div class="progress mt-3">
                <div class="progress-bar"></div>
            </div>
        </div>
    </div>

    <!-- Document Metadata Section -->
    {% if result.data.document.metadata %}
    <div class="card mb-4">
        <div class="card-header">
            <h3 class="card-title">DOCUMENT METADATA</h3>
        </div>
        <div class="card-body">
            <div class="row">
                {% if result.data.document.metadata.title %}
                <div class="col-12 col-md-6 mb-3">
                    <dt>TITLE:</dt>
                    <dd class="text-primary">{{ result.data.document.metadata.title }}</dd>
                </div>
                {% endif %}
                
                {% if result.data.document.metadata.author %}
                <div class="col-12 col-md-6 mb-3">
                    <dt>AUTHOR:</dt>
                    <dd class="text-accent">{{ result.data.document.metadata.author }}</dd>
                </div>
                {% endif %}
                
                {% if result.data.document.metadata.release_date %}
                <div class="col-12 col-md-6 mb-3">
                    <dt>RELEASE DATE:</dt>
                    <dd class="text-success">{{ result.data.document.metadata.release_date }}</dd>
                </div>
                {% endif %}
                
                {% if result.data.document.metadata.language %}
                <div class="col-12 col-md-6 mb-3">
                    <dt>LANGUAGE:</dt>
                    <dd class="text-secondary">{{ result.data.document.metadata.language|upper }}</dd>
                </div>
                {% endif %}
                
                {% if result.data.document.metadata.credits %}
                <div class="col-12 mb-3">
                    <dt>CREDITS:</dt>
                    <dd class="text-secondary">{{ result.data.document.metadata.credits }}</dd>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Document Body Section -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">NEURAL DOCUMENT CONTENT</h3>
            <small class="text-secondary">Structured content rendering with cyberpunk interface</small>
        </div>
        <div class="card-body">
            <div class="document-content">
                {% for block in result.data.document.body %}
                    {{ render_content_block(block) }}
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<!-- Interactive JavaScript for Document Viewer -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Add copy functionality to code blocks
    document.querySelectorAll('.raw-html-block').forEach(block => {
        const copyBtn = document.createElement('button');
        copyBtn.className = 'btn btn-outline btn-sm';
        copyBtn.textContent = 'COPY';
        copyBtn.onclick = function() {
            const content = block.querySelector('.html-content').textContent;
            navigator.clipboard.writeText(content).then(() => {
                copyBtn.textContent = 'âœ“ COPIED';
                copyBtn.classList.add('text-success');
                setTimeout(() => {
                    copyBtn.textContent = 'COPY';
                    copyBtn.classList.remove('text-success');
                }, 2000);
            });
        };
        
        block.appendChild(copyBtn);
    });
    
    // Add expand/collapse for long content
    document.querySelectorAll('.html-content').forEach(content => {
        if (content.scrollHeight > 300) {
            const expandBtn = document.createElement('button');
            expandBtn.className = 'btn btn-secondary btn-sm mt-2';
            expandBtn.textContent = 'EXPAND CONTENT';
            expandBtn.onclick = function() {
                if (content.classList.contains('expanded')) {
                    content.classList.remove('expanded');
                    expandBtn.textContent = 'EXPAND CONTENT';
                } else {
                    content.classList.add('expanded');
                    expandBtn.textContent = 'COLLAPSE CONTENT';
                }
            };
            content.parentNode.appendChild(expandBtn);
        }
    });
});
</script> 